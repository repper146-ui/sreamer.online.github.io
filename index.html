<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<title>Screamer</title>
<style>
body{
  margin:0;
  min-height:100vh;
  font-family:Arial;
  background:url('images/bg.jpg') center/cover no-repeat fixed;
  color:#fff;
  padding:20px;
}
header{display:flex;justify-content:space-between;align-items:center}
h1{text-align:center;flex:1}
section{
  background:rgba(18,0,0,0.7);
  padding:15px;
  border-radius:12px;
  margin-bottom:20px;
  box-shadow:0 0 20px rgba(255,0,0,.15);
}
input,select{
  padding:8px;
  border-radius:6px;
  border:none;
  margin-bottom:10px;
  width:100%;
}
button{
  background:#ffd400;
  border:none;
  border-radius:8px;
  padding:8px 12px;
  margin:4px;
  cursor:pointer;
  font-weight:bold;
  transition:all 0.2s ease;
}
button:hover{background:#ffea66; transform:scale(1.05);}
.grid{
  display:grid;
  grid-template-columns:repeat(auto-fit,minmax(120px,1fr));
  gap:10px;
}
.map{
  height:120px;
  border-radius:10px;
  background-size:cover;
  background-position:center;
  cursor:pointer;
  transition: transform 0.2s ease, box-shadow 0.2s ease;
}
.map:hover{transform:scale(1.05); box-shadow:0 0 10px #ffd400;}
.map.banned{filter:grayscale(1);opacity:.3}
.map.selected{outline:3px solid #ffd400; box-shadow:0 0 15px #ffd400;}
.player-item{
  display:flex;
  justify-content:space-between;
  align-items:center;
  margin-bottom:4px;
  background:rgba(0,0,0,0.4);
  padding:4px 6px;
  border-radius:6px;
}
.overlay{
  position:fixed; inset:0; background:rgba(0,0,0,0.95);
  padding:20px; overflow:auto; display:none; z-index:999; border-radius:12px;
}
</style>
</head>
<body>

<header>
<h1>SCREAMER</h1>
<button id="openBaseBtn">üë• –ò–≥—Ä–æ–∫–∏</button>
</header>

<!-- –ë–ê–ó–ê –ü–û–°–¢–û–Ø–ù–ù–´–• –ò–ì–†–û–ö–û–í -->
<div id="playerBase" class="overlay">
<h2>–ë–∞–∑–∞ –ø–æ—Å—Ç–æ—è–Ω–Ω—ã—Ö –∏–≥—Ä–æ–∫–æ–≤</h2>
<input id="baseName" placeholder="–ò–º—è –∏–≥—Ä–æ–∫–∞">
<select id="baseClass">
<option>–ê—Ç–∞–∫–∞</option>
<option>–†–µ–Ω–¥–∂</option>
<option>–¢–∞–Ω–∫</option>
<option>–•–∏–ª</option>
</select>
<button id="addBaseBtn">–î–æ–±–∞–≤–∏—Ç—å –∏–≥—Ä–æ–∫–∞</button>
<button id="closeBaseBtn">‚ùå –ó–∞–∫—Ä—ã—Ç—å</button>
<ul id="baseList"></ul>
</div>

<!-- –ò–ì–†–û–ö–ò –ù–ê –ú–ê–¢–ß -->
<section>
<h2>–î–æ–±–∞–≤–ª–µ–Ω–∏–µ –∏–≥—Ä–æ–∫–æ–≤ –≤ –º–∞—Ç—á</h2>
<input id="playerName" placeholder="–ò–º—è –∏–≥—Ä–æ–∫–∞">
<div>
<button data-class="–ê—Ç–∞–∫–∞">–ê—Ç–∞–∫–∞</button>
<button data-class="–†–µ–Ω–¥–∂">–†–µ–Ω–¥–∂</button>
<button data-class="–¢–∞–Ω–∫">–¢–∞–Ω–∫</button>
<button data-class="–•–∏–ª">–•–∏–ª</button>
</div>
<ul id="players"></ul>
</section>

<!-- –ö–û–ú–ê–ù–î–´ -->
<section>
<h2>–ö–æ–º–∞–Ω–¥—ã</h2>
<button id="randTeamBtn">üé≤ –†–∞–Ω–¥–æ–º –∫–æ–º–∞–Ω–¥</button>
<button id="customTeamBtn">‚úç –°–≤–æ—è –∫–æ–º–∞–Ω–¥–∞</button>
<div id="teams"></div>
</section>

<!-- –†–ï–ñ–ò–ú–´ -->
<section>
<h2>–†–µ–∂–∏–º—ã</h2>
<div id="modes">
<button>–°—Ä–∞–∂–µ–Ω–∏—è</button>
<button>–ë–æ–∏ –∑–∞ –±–∞–∑—ã</button>
<button>–§–ª–∞–≥–∏</button>
<button>–ë–∞—Ä—å–µ—Ä–Ω—ã–µ –±–æ–∏</button>
</div>
<button id="resetModesBtn">üîÑ –°–±—Ä–æ—Å —Ä–µ–∂–∏–º–æ–≤</button>
<p id="modesResult"></p>
</section>

<!-- –ö–ê–†–¢–´ -->
<section>
<h2>–ö–∞—Ä—Ç—ã</h2>
<div class="grid" id="maps"></div>
<button id="randMapBtn">üé≤ –°–ª—É—á–∞–π–Ω–∞—è –∫–∞—Ä—Ç–∞</button>
<button id="resetMapsBtn">üîÑ –°–±—Ä–æ—Å / –Ω–æ–≤—ã–µ –∫–∞—Ä—Ç—ã</button>
<h2 id="finalMap"></h2>
</section>

<!-- –ë–ê–ù–´ -->
<section>
<h2>–ë–∞–Ω —Ç–µ—Ö–Ω–∏–∫ –∏ –æ—Ä—É–∂–∏—è</h2>
<div id="banItems" class="grid">
<button>SS+ –æ—Ä—É–∂–∏–µ</button>
<button>–ô–æ–º–æ—Ç—Å—É –•–∏—Ä–∞—Å–∞–∫–∞</button>
<button>–®–∞—Ä–∏–Ω–≥–∞–Ω</button>
<button>–ö–∞—Ä–º–∞</button>
<button>–ö–∏–Ω–∂–∞–ª –®–∏—Å—É–∏</button>
<button>–ò–∑–∞–Ω–∞–º–∏ / –¢—Å—É–∫—É—ë–º–∏</button>
</div>
<p id="bannedItems"></p>
</section>

<script>
document.addEventListener("DOMContentLoaded",()=>{

// ===== –ë–ê–ó–ê –ü–û–°–¢–û–Ø–ù–ù–´–• –ò–ì–†–û–ö–û–í =====
let basePlayers=JSON.parse(localStorage.getItem("basePlayers")||"[]");
const playerBase=document.getElementById("playerBase");
const baseList=document.getElementById("baseList");

function toggleBase(){playerBase.style.display = playerBase.style.display==="none"?"block":"none";}

function renderBasePlayers(){
  baseList.innerHTML="";
  basePlayers.forEach((p,i)=>{
    baseList.innerHTML+=`<li class="player-item">${p.name} ‚Äî ${p.class}
    <button onclick="addFromBase(${i})">‚ûï</button>
    <button onclick="removeBasePlayer(${i})">‚ùå</button>
    </li>`;
  });
}

function addBasePlayer(){
  let n=document.getElementById("baseName").value;
  let c=document.getElementById("baseClass").value;
  if(!n) return;
  basePlayers.push({name:n,class:c});
  localStorage.setItem("basePlayers",JSON.stringify(basePlayers));
  document.getElementById("baseName").value="";
  renderBasePlayers();
}

window.removeBasePlayer=i=>{
  if(confirm(`–£–¥–∞–ª–∏—Ç—å ${basePlayers[i].name} –∏–∑ –±–∞–∑—ã?`)){
    basePlayers.splice(i,1);
    localStorage.setItem("basePlayers",JSON.stringify(basePlayers));
    renderBasePlayers();
  }
}

window.addFromBase=i=>{
  players.push({name:basePlayers[i].name,cls:basePlayers[i].class});
  renderPlayers();
}

// ===== –ò–ì–†–û–ö–ò –ù–ê –ú–ê–¢–ß =====
let players=[];
const playersEl=document.getElementById("players");

function renderPlayers(){
  playersEl.innerHTML="";
  players.forEach((p,i)=>{
    playersEl.innerHTML+=`<li class="player-item">${p.name} ‚Äî ${p.cls} <button onclick="removePlayer(${i})">‚ùå</button></li>`;
  });
}

window.removePlayer=i=>{
  players.splice(i,1);
  renderPlayers();
}

document.querySelectorAll('[data-class]').forEach(b=>{
  b.addEventListener("click",()=>{
    let n=document.getElementById("playerName").value;
    if(!n) return;
    players.push({name:n,cls:b.getAttribute("data-class")});
    document.getElementById("playerName").value="";
    renderPlayers();
  });
});

// ===== –ö–û–ú–ê–ù–î–´ =====
const teams=document.getElementById("teams");
function showTeams(a,b){
  teams.innerHTML=`<b>–ö–æ–º–∞–Ω–¥–∞ A</b><br>${a.map(p=>p.name).join("<br>")}
  <hr>
  <b>–ö–æ–º–∞–Ω–¥–∞ B</b><br>${b.map(p=>p.name).join("<br>")}
  `;
}

document.getElementById("randTeamBtn").onclick=()=>{
  if(players.length<8){alert("–ù—É–∂–Ω–æ 8 –∏–≥—Ä–æ–∫–æ–≤"); return;}
  let classes=["–ê—Ç–∞–∫–∞","–†–µ–Ω–¥–∂","–¢–∞–Ω–∫","–•–∏–ª"];
  let A=[],B=[];
  for(let c of classes){
    let pool=players.filter(p=>p.cls===c).sort(()=>Math.random()-0.5);
    if(pool.length<2){alert("–ù–µ —Ö–≤–∞—Ç–∞–µ—Ç –∫–ª–∞—Å—Å–∞ "+c); return;}
    A.push(pool[0]); B.push(pool[1]);
  }
  showTeams(A,B);
}

document.getElementById("customTeamBtn").onclick=()=>{
  showTeams(players.slice(0,4), players.slice(4,8));
}

// ===== –†–ï–ñ–ò–ú–´ =====
let bannedModes=0;
const modesResult=document.getElementById("modesResult");
document.querySelectorAll("#modes button").forEach(b=>{
  b.addEventListener("click",()=>{
    if(b.disabled||bannedModes>=2) return;
    b.disabled=true; b.style.opacity=0.4; bannedModes++;
    if(bannedModes===2){
      let active=[...document.querySelectorAll("#modes button:not(:disabled)")];
      modesResult.innerText="–ò–≥—Ä–∞–µ–º: "+active.map(btn=>btn.innerText).join(", ");
    }
  });
});
document.getElementById("resetModesBtn").addEventListener("click",()=>{
  bannedModes=0; modesResult.innerText="";
  document.querySelectorAll("#modes button").forEach(b=>{b.disabled=false;b.style.opacity=1;});
});

// ===== –ö–ê–†–¢–´ =====
const mapContainer=document.getElementById("maps");
const finalMap=document.getElementById("finalMap");
let mapBans=0;
let allMaps=[...Array(25)].map((_,i)=>`maps/${i+1}.png`);

function loadMaps(){
  mapContainer.innerHTML="";
  mapBans=0;
  finalMap.innerText="";
  let selected=[...allMaps].sort(()=>Math.random()-0.5).slice(0,5);
  selected.forEach(src=>{
    let d=document.createElement("div");
    d.className="map";
    d.style.backgroundImage=`url('${src}')`;
    d.onclick=()=>{
      if(d.classList.contains("banned")||mapBans>=4)return;
      d.classList.add("banned");
      mapBans++;
      checkMap();
    };
    mapContainer.appendChild(d);
  });
}

function checkMap(){
  let active=[...document.querySelectorAll(".map:not(.banned)")];
  if(active.length===1){
    active[0].classList.add("selected");
    finalMap.innerText="–ò–ì–†–ê–ï–ú –ù–ê –≠–¢–û–ô –ö–ê–†–¢–ï";
  }
}

document.getElementById("randMapBtn").onclick=()=>{
  mapBans=0;
  finalMap.innerText="";
  document.querySelectorAll(".map").forEach(m=>m.classList.remove("banned","selected"));
  // –±–∞–Ω–∏–º —Å–ª—É—á–∞–π–Ω–æ 4 –∫–∞—Ä—Ç—ã
  let mapsArr=[...document.querySelectorAll(".map")];
  mapsArr.sort(()=>Math.random()-0.5).slice(0,4).forEach(m=>m.classList.add("banned"));
  mapBans=4;
  checkMap();
};

document.getElementById("resetMapsBtn").onclick=loadMaps;

// ===== –ë–ê–ù–´ =====
let bannedArr=[];
const bannedItems=document.getElementById("bannedItems");
document.querySelectorAll("#banItems button").forEach(b=>{
  b.addEventListener("click",()=>{
    let item=b.innerText;
    if(bannedArr.includes(item)){ bannedArr=bannedArr.filter(x=>x!==item); b.style.opacity=1; }
    else{ bannedArr.push(item); b.style.opacity=0.4; }
    bannedItems.innerText="–ó–∞–±–∞–Ω–µ–Ω–æ: "+bannedArr.join(", ");
  });
});

// ===== –ö–ù–û–ü–ö–ò =====
document.getElementById("openBaseBtn").addEventListener("click",()=>{playerBase.style.display="block";});
document.getElementById("closeBaseBtn").addEventListener("click",()=>{playerBase.style.display="none";});
document.getElementById("addBaseBtn").addEventListener("click",addBasePlayer);

// ===== –ò–ù–ò–¶–ò–ê–õ–ò–ó–ê–¶–ò–Ø =====
renderBasePlayers();
renderPlayers();
loadMaps();

});
</script>
</body>
</html>